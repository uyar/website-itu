

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Application Structure &mdash; Flask Tutorial</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Data Model" href="data-model.html" />
    <link rel="prev" title="1. Basics" href="basics.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Flask Application Development
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basics.html">1. Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Application Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#base-templates">2.1. Base Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#url-generation">2.2. URL Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#code-structure">2.3. Code Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#application-configuration">2.4. Application Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-model.html">3. Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="forms.html">4. Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="logins.html">5. Logins</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistence.html">6. Persistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="solutions.html">7. Solutions to Exercises</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flask Application Development</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>2. Application Structure</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="application-structure">
<h1>2. Application Structure<a class="headerlink" href="#application-structure" title="Permalink to this headline">¶</a></h1>
<p>The pages in a web application share some components such as headers, footers
and navigation panels. In this chapter, we’ll see how to implement such
components without repeating code. We’ll create a base template that will
contain the components that all pages in the application will include.
See <a class="reference internal" href="#fig-structure-homepage"><span class="std std-numref">Fig. 2.1</span></a> for the screenshot of the resulting
home page.</p>
<div class="figure align-center" id="id2">
<span id="fig-structure-homepage"></span><img alt="Screenshot of home page with navigation panel and footer." src="_images/structure_homepage.png" />
<p class="caption"><span class="caption-number">Fig. 2.1 </span><span class="caption-text">Home page containing navigation panel and footer.</span></p>
</div>
<div class="section" id="base-templates">
<h2>2.1. Base Templates<a class="headerlink" href="#base-templates" title="Permalink to this headline">¶</a></h2>
<p>Manually adding shared components to multiple pages in an application
is tedious and error-prone. We would prefer to write these once and let pages
get them from a shared location. For instance, we want all pages to use
the same footer that contains a copyright notice but we don’t want to add
the footer markup to every page separately. Instead, we want to add it
to a base template and derive all pages from this base template.</p>
<p>We’ll store our base template in the <code class="file docutils literal notranslate"><span class="pre">layout.html</span></code> file with the contents
given in <a class="reference internal" href="#lst-layout-v0201"><span class="std std-numref">Listing 2.1</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<span id="lst-layout-v0201"></span><div class="code-block-caption"><span class="caption-number">Listing 2.1 </span><span class="caption-text">Initial base template
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">templates/layout.html</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0201</span></code>).</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">/&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My movies - {% block title %}{% endblock %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span>    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/static/mymovies.css&quot;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="hll">    {% block content %}{% endblock %}
</span>
    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span><span class="ni">&amp;copy;</span> 2015-2018, Kilgore Trout<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">...</span> <span class="pre">%}</span></code> and <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">endblock</span> <span class="pre">%}</span></code> directives in Jinja mark
the parts that will be filled in by the pages that use this base template.
Since there can be more than one such block in a template, blocks have to be
named so that they can be distinguished from each other. The name is
the identifier that follows the <code class="docutils literal notranslate"><span class="pre">block</span></code> keyword in the opening directive.</p>
<p>All remaining parts will be directly included. This means that there are
two parts in this template that will be filled in by pages:</p>
<ul class="simple">
<li>The block named <code class="docutils literal notranslate"><span class="pre">title</span></code> marks the page title after the common prefix
(line 5).</li>
<li>The block named <code class="docutils literal notranslate"><span class="pre">content</span></code> marks the page content (line 9). Note that
the footer is not part of the block, so it will be included in all
pages (lines 11-13).</li>
</ul>
<p>Now the home page template will extend this base template
(<a class="reference internal" href="#lst-home-v0201"><span class="std std-numref">Listing 2.2</span></a>, line 1). The <code class="docutils literal notranslate"><span class="pre">title</span></code> block (line 2) will replace
the <code class="docutils literal notranslate"><span class="pre">title</span></code> slot in the layout, and the <code class="docutils literal notranslate"><span class="pre">content</span></code> block (lines between
3 and 10) will replace the <code class="docutils literal notranslate"><span class="pre">content</span></code> slot. When processed, this template will
give the same markup as the previous one without the base template
(<a class="reference internal" href="basics.html#lst-home-v0104"><span class="std std-numref">Listing 1.9</span></a>).</p>
<div class="literal-block-wrapper docutils container" id="id4">
<span id="lst-home-v0201"></span><div class="code-block-caption"><span class="caption-number">Listing 2.2 </span><span class="caption-text">Home page template extending the base template
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">templates/home.html</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0201</span></code>).</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>{% extends &quot;layout.html&quot; %}
{% block title %}Home{% endblock %}
{% block content %}
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>My movie collection<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Have a nice {{ day }}!<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/movies&quot;</span><span class="p">&gt;</span>List movies<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{% endblock %}
</pre></div>
</td></tr></table></div>
</div>
<p>Let’s also add the following rule to the style sheet to format the footer:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="nt">footer</span> <span class="p">{</span>
    <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="url-generation">
<h2>2.2. URL Generation<a class="headerlink" href="#url-generation" title="Permalink to this headline">¶</a></h2>
<p>In our HTML markup we’ve used fixed routes when writing links to pages:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">/</span></code> for the home page</li>
<li><code class="docutils literal notranslate"><span class="pre">/movies</span></code> for the movies page</li>
<li><code class="docutils literal notranslate"><span class="pre">/static/mymovies.css</span></code> for the style sheet</li>
</ul>
<p>These routes assume that all our URLs start from the base of the server URL
(<code class="docutils literal notranslate"><span class="pre">http://localhost:8080</span></code>). But in some cases -for example if we want to run
multiple applications on the same port- we may want our application URLs
to start from a subpath on the server, like <code class="docutils literal notranslate"><span class="pre">http://localhost:8080/myapp</span></code>.
So we would want our URLs to be:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">http://localhost:8080/myapp/</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">http://localhost:8080/myapp/movies</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">http://localhost:8080/myapp/static/mymovies.css</span></code></li>
</ul>
<p>But using fixed routes wouldn’t work in this case because for example
<code class="docutils literal notranslate"><span class="pre">/movies</span></code> would always link to <code class="docutils literal notranslate"><span class="pre">http://localhost:8080/movies</span></code>.</p>
<p>We can solve this issue using a Flask function called <code class="docutils literal notranslate"><span class="pre">url_for</span></code> which lets us
look up the URL of a page in the application. Routing rules consist of three
components:</p>
<ol class="arabic simple">
<li>The route in the application, e.g. <code class="docutils literal notranslate"><span class="pre">/movies</span></code>.</li>
<li>The view function that will handle the requests to this route,
e.g. <code class="docutils literal notranslate"><span class="pre">movies_page</span></code>.</li>
<li>The name of the <em>endpoint</em>, which is an identifier for the route.
If not given, this will be the same as the name of the view function,
e.g. <code class="docutils literal notranslate"><span class="pre">movies_page</span></code>. <a class="footnote-reference" href="#route-endpoint" id="id1">[1]</a></li>
</ol>
<p>So for example, instead of writing the URL for the movies page as <code class="docutils literal notranslate"><span class="pre">/movies</span></code>,
we call the <code class="docutils literal notranslate"><span class="pre">url_for</span></code> function and give it the endpoint name
(<code class="docutils literal notranslate"><span class="pre">movies_page</span></code>) to get its URL (<a class="reference internal" href="#lst-home-v0202"><span class="std std-numref">Listing 2.3</span></a>, line 8).</p>
<div class="literal-block-wrapper docutils container" id="id5">
<span id="lst-home-v0202"></span><div class="code-block-caption"><span class="caption-number">Listing 2.3 </span><span class="caption-text">Home page template with URL generation
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">templates/home.html</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0202</span></code>).</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>{% extends &quot;layout.html&quot; %}
{% block title %}Home{% endblock %}
{% block content %}
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>My movie collection<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Have a nice {{ day }}!<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
<span class="hll">      <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;movies_page&#39;) }}&quot;</span><span class="p">&gt;</span>List movies<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span>    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{% endblock %}
</pre></div>
</td></tr></table></div>
</div>
<p>For static files, we have to use the endpoint name <code class="docutils literal notranslate"><span class="pre">static</span></code> and give
the relative path of the requested file (<a class="reference internal" href="#lst-layout-v0202"><span class="std std-numref">Listing 2.4</span></a>,
lines 6-7).</p>
<div class="literal-block-wrapper docutils container" id="id6">
<span id="lst-layout-v0202"></span><div class="code-block-caption"><span class="caption-number">Listing 2.4 </span><span class="caption-text">Base template with URL generation for static files
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">templates/layout.html</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0202</span></code>).</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My movies - {% block title %}{% endblock %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span>
</span><span class="hll">          <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;static&#39;, filename=&#39;mymovies.css&#39;) }}&quot;</span><span class="p">/&gt;</span>
</span>  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    {% block content %}{% endblock %}

    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span><span class="ni">&amp;copy;</span> 2015-2018, Kilgore Trout<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Another improvement concerns the navigation. We might need links
to the home page or the movie list page from many pages in the application.
So, having a global navigation mechanism where all such links will be available
in all pages would be a good idea.</p>
<p>We’ll add the navigation links as part of a header section in our base
template (<a class="reference internal" href="#lst-layout-v0203"><span class="std std-numref">Listing 2.5</span></a>, lines 10-17).</p>
<div class="literal-block-wrapper docutils container" id="id7">
<span id="lst-layout-v0203"></span><div class="code-block-caption"><span class="caption-number">Listing 2.5 </span><span class="caption-text">Base template with navigation links
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">templates/layout.html</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0203</span></code>).</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-html notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">/&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My movies - {% block title %}{% endblock %}<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span>
          <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;static&#39;, filename=&#39;mymovies.css&#39;) }}&quot;</span><span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">header</span><span class="p">&gt;</span>
</span><span class="hll">      <span class="p">&lt;</span><span class="nt">nav</span><span class="p">&gt;</span>
</span><span class="hll">        <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
</span><span class="hll">          <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;home_page&#39;) }}&quot;</span><span class="p">&gt;</span>Home<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span class="hll">          <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;movies_page&#39;) }}&quot;</span><span class="p">&gt;</span>List movies<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</span><span class="hll">        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</span><span class="hll">      <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
</span><span class="hll">    <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
</span>
    {% block content %}{% endblock %}

    <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">small</span><span class="p">&gt;</span><span class="ni">&amp;copy;</span> 2015-2018, Kilgore Trout<span class="p">&lt;/</span><span class="nt">small</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Now the home page doesn’t need to add the navigation links anymore
(<a class="reference internal" href="#lst-home-v0203"><span class="std std-numref">Listing 2.6</span></a>).</p>
<div class="literal-block-wrapper docutils container" id="id8">
<span id="lst-home-v0203"></span><div class="code-block-caption"><span class="caption-number">Listing 2.6 </span><span class="caption-text">Home page template that gets navigation links from base template
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">templates/home.html</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0203</span></code>).</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-udiff notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="gd">--- /home/uyar/Projects/flask-tutorial/app/v0202/templates/home.html</span>
<span class="gi">+++ /home/uyar/Projects/flask-tutorial/app/v0203/templates/home.html</span>
<span class="gu">@@ -3,8 +3,4 @@</span>
 {% block content %}
     &lt;h1&gt;My movie collection&lt;/h1&gt;
     &lt;p&gt;Have a nice {{ day }}!&lt;/p&gt;
<span class="gd">-</span>
<span class="gd">-    &lt;ul&gt;</span>
<span class="gd">-      &lt;li&gt;&lt;a href=&quot;{{ url_for(&#39;movies_page&#39;) }}&quot;&gt;List movies&lt;/a&gt;&lt;/li&gt;</span>
<span class="gd">-    &lt;/ul&gt;</span>
 {% endblock %}
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition-exercise-1 admonition">
<p class="first admonition-title">Exercise 1</p>
<p class="last">Arrange the movie list page so that it will use the same navigation panel
and footer. (<a class="reference internal" href="solutions.html#solutions-structure-layout"><span class="std std-ref">Solution</span></a>)</p>
</div>
<div class="admonition-exercise-2 admonition">
<p class="first admonition-title">Exercise 2</p>
<p>Add <a class="reference external" href="https://bulma.io/">Bulma</a> to your base template and arrange
your pages to use it. Try to achieve a screenshot as given in
<a class="reference internal" href="#fig-solutions-bulma"><span class="std std-numref">Fig. 2.2</span></a>. (<a class="reference internal" href="solutions.html#solutions-structure-bulma"><span class="std std-ref">Solution</span></a>)</p>
<div class="last figure align-center" id="id9">
<span id="fig-solutions-bulma"></span><img alt="Screenshot of home page with Bulma." src="_images/solutions_bulma.png" />
<p class="caption"><span class="caption-number">Fig. 2.2 </span><span class="caption-text">Home page using Bulma.</span></p>
</div>
</div>
</div>
<div class="section" id="code-structure">
<h2>2.3. Code Structure<a class="headerlink" href="#code-structure" title="Permalink to this headline">¶</a></h2>
<p>As the project gets larger, we will want to separate the code into multiple
source files. For example, in our application, it might be a good idea
to move the view functions into a separate module, as given
in <a class="reference internal" href="#lst-views-v0204"><span class="std std-numref">Listing 2.7</span></a>.</p>
<div class="literal-block-wrapper docutils container" id="id10">
<span id="lst-views-v0204"></span><div class="code-block-caption"><span class="caption-number">Listing 2.7 </span><span class="caption-text">Module that contains the view functions
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">views.py</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0204</span></code>).</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">render_template</span>


<span class="k">def</span> <span class="nf">home_page</span><span class="p">():</span>
    <span class="n">today</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
    <span class="n">day_name</span> <span class="o">=</span> <span class="n">today</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%A&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;home.html&quot;</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="n">day_name</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">movies_page</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s2">&quot;movies.html&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Now the question is, how do we register the routes in the application?
One way would be to import the <code class="docutils literal notranslate"><span class="pre">app</span></code> variable from the <code class="docutils literal notranslate"><span class="pre">server.py</span></code> module
and use the <code class="docutils literal notranslate"><span class="pre">route</span></code> decorator as before:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">server</span> <span class="kn">import</span> <span class="n">app</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home_page</span><span class="p">():</span>
    <span class="o">...</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/movies&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">movies_page</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>If you don’t like using global variables this way, you can use
the <code class="docutils literal notranslate"><span class="pre">add_url_rule</span></code> method of the application instance when creating
the application. It’s also a good idea to handle application creation
as a separate function instead of defining a global variable
(<a class="reference internal" href="#lst-server-v0204"><span class="std std-numref">Listing 2.8</span></a>, lines 6-12 and 16).</p>
<div class="literal-block-wrapper docutils container" id="id11">
<span id="lst-server-v0204"></span><div class="code-block-caption"><span class="caption-number">Listing 2.8 </span><span class="caption-text">Server module for application setup
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">server.py</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0204</span></code>).</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="kn">import</span> <span class="nn">views</span>


<span class="k">def</span> <span class="nf">create_app</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">home_page</span><span class="p">)</span>
</span><span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s2">&quot;/movies&quot;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">movies_page</span><span class="p">)</span>
</span>
    <span class="k">return</span> <span class="n">app</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="application-configuration">
<h2>2.4. Application Configuration<a class="headerlink" href="#application-configuration" title="Permalink to this headline">¶</a></h2>
<p>Flask application instances keep their configuration as a mapping
in an instance member named <code class="docutils literal notranslate"><span class="pre">config</span></code>. For example, the application can be
configured to run in debug mode using the <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> key (line 3), in which case
the corresponding parameter isn’t needed in the <code class="docutils literal notranslate"><span class="pre">run</span></code> method anymore
(line 8):</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_app</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
</span>    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>
<span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
<p>You can also add your own settings to this mapping. For example, you can
make the port number a configuration setting (line 4), get its value or
an optional default (line 9) and use it (line 10):</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_app</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;DEBUG&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
<span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;PORT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8080</span>
</span>    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>
<span class="hll">    <span class="n">port</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PORT&quot;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
</span><span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>
</span></pre></div>
</td></tr></table></div>
<p>It’s common practice to keep the configuration in a separate file. Flask
allows you to load the configuration from a Python source file. For example,
let us create a <code class="file docutils literal notranslate"><span class="pre">settings.py</span></code> file (<a class="reference internal" href="#lst-settings-v0205"><span class="std std-numref">Listing 2.9</span></a>)
and put these settings into it:</p>
<div class="literal-block-wrapper docutils container" id="id12">
<span id="lst-settings-v0205"></span><div class="code-block-caption"><span class="caption-number">Listing 2.9 </span><span class="caption-text">Settings file with debug mode and port
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">settings.py</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0205</span></code>).</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">DEBUG</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">8080</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Now use this file to configure the application (<a class="reference internal" href="#lst-server-v0205"><span class="std std-numref">Listing 2.10</span></a>,
line 8):</p>
<div class="literal-block-wrapper docutils container" id="id13">
<span id="lst-server-v0205"></span><div class="code-block-caption"><span class="caption-number">Listing 2.10 </span><span class="caption-text">Application configured through settings file
(file:&nbsp;<code class="file docutils literal notranslate"><span class="pre">server.py</span></code>, version:&nbsp;<code class="docutils literal notranslate"><span class="pre">v0205</span></code>).</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="kn">import</span> <span class="nn">views</span>


<span class="k">def</span> <span class="nf">create_app</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="hll">    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="s2">&quot;settings&quot;</span><span class="p">)</span>
</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">home_page</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_url_rule</span><span class="p">(</span><span class="s2">&quot;/movies&quot;</span><span class="p">,</span> <span class="n">view_func</span><span class="o">=</span><span class="n">views</span><span class="o">.</span><span class="n">movies_page</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">app</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>
    <span class="n">port</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PORT&quot;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;0.0.0.0&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<table class="docutils footnote" frame="void" id="route-endpoint" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><p class="first">When using the <code class="docutils literal notranslate"><span class="pre">&#64;route</span></code> decorator, you can use the <code class="docutils literal notranslate"><span class="pre">endpoint</span></code> parameter
to change the endpoint name:</p>
<div class="last highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/movies&quot;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;movies_endpoint&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">movies_page</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
</td></tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data-model.html" class="btn btn-neutral float-right" title="3. Data Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basics.html" class="btn btn-neutral" title="1. Basics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, H. Turgut Uyar

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>